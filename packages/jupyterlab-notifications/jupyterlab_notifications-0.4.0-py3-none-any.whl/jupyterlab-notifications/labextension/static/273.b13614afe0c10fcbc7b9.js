(self.webpackChunkjupyterlab_notifications=self.webpackChunkjupyterlab_notifications||[]).push([[273],{6273:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>f});var i=o(6749),n=o(2406),c=o(5351),s=o(6592),l=o.n(s),a=o(5131),r=o.n(a);function u(e){"granted"!==e&&alert("Browser Notifications are not allowed. Please update your browser settings to allow notifications.")}function d(e,t,o,i,n,s,l,a,u,d,m){const f=new Date,p=e.model,b="code"===p.type,g=p.value.text.length>0;if(b&&g){const e=p.id,b=t.id,g=o.get(e),_=g.scheduledTime,w=i.get(b)||_,x=_>=w?_:w;i.set(b,f);const h=r().utc(r()(f).diff(x)).format("HH:mm:ss");r().duration(h).asSeconds()>=n&&function(e,t,o,i,n,s,l,a){const r={icon:c.PageConfig.getBaseUrl()+"static/favicon.ico",body:""},u=s?`${o} Failed!`:`${o} Completed!`;let d="";s?d=l?`${l.errorName} ${l.errorValue}`:"":a?d=`Total Duration: ${e}`:i&&n?d=`Cell[${t}] Duration: ${e}`:i?d=`Cell Number: ${t}`:n&&(d=`Cell Duration: ${e}`),r.body=d,new Notification(u,r)}(h,"cell_index"===a?g.index:p.executionCount,t.title.label.replace(/\.[^/.]+$/,""),s,l,u,d,m)}}const m={id:"jupyterlab-notifications:plugin",autoStart:!0,requires:[n.ISettingRegistry],activate:async(e,t)=>{"Notification"in window?"granted"!==Notification.permission&&(function(){try{Notification.requestPermission().then()}catch(e){return!1}return!0}()?Notification.requestPermission().then((e=>{u(e)})):Notification.requestPermission((e=>{u(e)}))):alert("This browser does not support notifications.");let o=!0,n=60,c=!0,s=!0,a="cell_index",r=!1;const f=new(l())({max:2500}),p=new(l())({max:500});if(t){const e=await t.load(m.id),i=()=>{o=e.get("enabled").composite,n=e.get("minimum_cell_execution_time").composite,c=e.get("report_cell_execution_time").composite,s=e.get("report_cell_number").composite,a=e.get("cell_number_type").composite,r=e.get("last_cell_only").composite};i(),e.changed.connect(i)}i.NotebookActions.executionScheduled.connect(((e,t)=>{const{cell:i,notebook:n}=t;o&&f.set(i.model.id,{index:n.activeCellIndex,scheduledTime:new Date})})),i.NotebookActions.executed.connect(((e,t)=>{if(o&&!r){const{cell:e,notebook:o,success:i,error:l}=t;d(e,o,f,p,n,s,c,a,!i,l,r)}})),i.NotebookActions.selectionExecuted.connect(((e,t)=>{if(o&&r){const{lastCell:e,notebook:o}=t;d(e,o,f,p,n,s,c,a,!1,null,r)}}))}},f=m}}]);