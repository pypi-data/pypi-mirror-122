(self.webpackChunkjupyterlab_notifications=self.webpackChunkjupyterlab_notifications||[]).push([[273],{6273:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>m});var i=o(2136),n=o(1790),c=o(6592),s=o.n(c),l=o(5131),a=o.n(l);function r(e){"granted"!==e&&alert("Browser Notifications are not allowed. Please update your browser settings to allow notifications.")}function u(e,t,o,i,n,c,s,l,r,u,d){const m=new Date,f=e.model,p="code"===f.type,b=f.value.text.length>0;if(p&&b){const e=f.id,p=t.id,b=o.get(e),g=b.scheduledTime,_=i.get(p)||g,w=g>=_?g:_;i.set(p,m);const x=a().utc(a()(m).diff(w)).format("HH:mm:ss");a().duration(x).asSeconds()>=n&&function(e,t,o,i,n,c,s,l){const a={icon:"/static/favicon.ico",body:""},r=c?`${o} Failed!`:`${o} Completed!`;let u="";c?u=s?`${s.errorName} ${s.errorValue}`:"":l?u=`Total Duration: ${e}`:i&&n?u=`Cell[${t}] Duration: ${e}`:i?u=`Cell Number: ${t}`:n&&(u=`Cell Duration: ${e}`),a.body=u,new Notification(r,a)}(x,"cell_index"===l?b.index:f.executionCount,t.title.label.replace(/\.[^/.]+$/,""),c,s,r,u,d)}}const d={id:"jupyterlab-notifications:plugin",autoStart:!0,requires:[n.ISettingRegistry],activate:async(e,t)=>{"Notification"in window?"granted"!==Notification.permission&&(function(){try{Notification.requestPermission().then()}catch(e){return!1}return!0}()?Notification.requestPermission().then((e=>{r(e)})):Notification.requestPermission((e=>{r(e)}))):alert("This browser does not support notifications.");let o=!0,n=60,c=!0,l=!0,a="cell_index",m=!1;const f=new(s())({max:2500}),p=new(s())({max:500});if(t){const e=await t.load(d.id),i=()=>{o=e.get("enabled").composite,n=e.get("minimum_cell_execution_time").composite,c=e.get("report_cell_execution_time").composite,l=e.get("report_cell_number").composite,a=e.get("cell_number_type").composite,m=e.get("last_cell_only").composite};i(),e.changed.connect(i)}i.NotebookActions.executionScheduled.connect(((e,t)=>{const{cell:i,notebook:n}=t;o&&f.set(i.model.id,{index:n.activeCellIndex,scheduledTime:new Date})})),i.NotebookActions.executed.connect(((e,t)=>{if(o&&!m){const{cell:e,notebook:o,success:i,error:s}=t;u(e,o,f,p,n,l,c,a,!i,s,m)}})),i.NotebookActions.selectionExecuted.connect(((e,t)=>{if(o&&m){const{lastCell:e,notebook:o}=t;u(e,o,f,p,n,l,c,a,!1,null,m)}}))}},m=d}}]);