var e="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function t(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}var r=t,i=n;function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===t||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}"function"==typeof e.setTimeout&&(r=setTimeout),"function"==typeof e.clearTimeout&&(i=clearTimeout);var f,u=[],c=!1,o=-1;function l(){c&&f&&(c=!1,f.length?u=f.concat(u):o=-1,u.length&&s())}function s(){if(!c){var e=a(l);c=!0;for(var t=u.length;t;){for(f=u,u=[];++o<t;)f&&f[o].run();o=-1,t=u.length}f=null,c=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===n||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}d.prototype.run=function(){this.fun.apply(null,this.array)};function b(){}var p=b,y=b,m=b,h=b,w=b,E=b,g=b;var x=e.performance||{},v=x.now||x.mozNow||x.msNow||x.oNow||x.webkitNow||function(){return(new Date).getTime()};var O=new Date;var R={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||c||a(s)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:p,addListener:y,once:m,off:h,removeListener:w,removeAllListeners:E,emit:g,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*v.call(x),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-O)/1e3}};function q(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}function F(e){var t={exports:{}};return e(t,t.exports),t.exports}var P=F((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isogenyCoefficients=t.psi2=t.psi=t.millerLoop=t.calcPairingPrecomputes=t.isogenyMapG2=t.map_to_curve_SSWU_G2=t.ProjectivePoint=t.Fq12=t.Fq6=t.Fq2=t.Fr=t.Fq=t.powMod=t.mod=t.DST_LABEL=t.CURVE=void 0,t.CURVE={P:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,r:0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h:0x396c8c005555e1568c00aaab0000aaabn,Gx:0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn,Gy:0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n,b:4n,P2:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn**2n-1n,h2:0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5n,G2x:[0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en],G2y:[0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben],b2:[4n,4n],x:0xd201000000010000n,h_eff:0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551n},t.DST_LABEL="BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_";const n=a(t.CURVE.x);function r(e,t){const n=e%t;return n>=0n?n:t+n}function i(e,t,n){let r=1n;for(;t>0n;)1n&t&&(r=r*e%n),e=e*e%n,t>>=1n;return r}function a(e){let t;for(t=0;e>0n;e>>=1n,t+=1);return t}function f(e,t){return e>>BigInt(t)&1n}function u(e,n=t.CURVE.P){if(0n===e||n<=0n)throw new Error("invert: expected positive integers");let i=r(e,n),a=n,[f,u,c,o]=[0n,1n,1n,0n];for(;0n!==i;){const e=a/i,t=a%i,n=f-c*e,r=u-o*e;[a,i]=[i,t],[f,u]=[c,o],[c,o]=[n,r]}if(1n!==a)throw new Error("invert: does not exist");return r(f,n)}t.mod=r,t.powMod=i;class c{constructor(e){this.value=r(e,c.ORDER)}isZero(){return 0n===this.value}equals(e){return this.value===e.value}negate(){return new c(-this.value)}invert(){return new c(u(this.value,c.ORDER))}add(e){return new c(this.value+e.value)}square(){return new c(this.value*this.value)}pow(e){return new c(i(this.value,e,c.ORDER))}subtract(e){return new c(this.value-e.value)}multiply(e){return e instanceof c&&(e=e.value),new c(this.value*e)}div(e){const t="bigint"==typeof e?new c(e).invert().value:e.invert();return this.multiply(t)}toString(){const e=this.value.toString(16).padStart(96,"0");return e.slice(0,2)+"."+e.slice(-2)}}t.Fq=c,c.ORDER=t.CURVE.P,c.MAX_BITS=a(t.CURVE.P),c.ZERO=new c(0n),c.ONE=new c(1n);class o{constructor(e){this.value=r(e,o.ORDER)}static isValid(e){return e<=o.ORDER}isZero(){return 0n===this.value}equals(e){return this.value===e.value}negate(){return new o(-this.value)}invert(){return new o(u(this.value,o.ORDER))}add(e){return new o(this.value+e.value)}square(){return new o(this.value*this.value)}pow(e){return new o(i(this.value,e,o.ORDER))}subtract(e){return new o(this.value-e.value)}multiply(e){return e instanceof o&&(e=e.value),new o(this.value*e)}div(e){const t="bigint"==typeof e?new o(e).invert().value:e.invert();return this.multiply(t)}legendre(){return this.pow((o.ORDER-1n)/2n)}sqrt(){if(!this.legendre().equals(o.ONE))return;const e=o.ORDER;let t,n,a;for(t=e-1n,n=0;t%2n===0n;t/=2n,n++);if(1===n)return this.pow((e+1n)/4n);for(a=2n;a<e&&new o(a).legendre().value!==e-1n;a++);let f=i(a,t,e),u=i(this.value,(t+1n)/2n,e),c=i(this.value,t,e),l=0n;for(;0n!==r(c-1n,e);){let t;for(l=r(c*c,e),t=1;t<n&&0n!==r(l-1n,e);t++)l=r(l*l,e);let a=i(f,BigInt(1<<n-t-1),e);u=r(u*a,e),f=r(a*a,e),c=r(c*f,e),n=t}return new o(u)}toString(){return"0x"+this.value.toString(16).padStart(64,"0")}}t.Fr=o,o.ORDER=t.CURVE.r,o.ZERO=new o(0n),o.ONE=new o(1n);class l{zip(e,t){const n=this.c,r=e.c,i=[];for(let e=0;e<n.length;e++)i.push(t(n[e],r[e]));return i}map(e){return this.c.map(e)}isZero(){return this.c.every((e=>e.isZero()))}equals(e){return this.zip(e,((e,t)=>e.equals(t))).every((e=>e))}negate(){return this.init(this.map((e=>e.negate())))}add(e){return this.init(this.zip(e,((e,t)=>e.add(t))))}subtract(e){return this.init(this.zip(e,((e,t)=>e.subtract(t))))}conjugate(){return this.init([this.c[0],this.c[1].negate()])}one(){const e=this;let t;return e instanceof m&&(t=m.ONE),e instanceof h&&(t=h.ONE),e instanceof w&&(t=w.ONE),t}pow(e){const t=this.one();if(0n===e)return t;if(1n===e)return this;let n=t,r=this;for(;e>0n;)1n&e&&(n=n.multiply(r)),e>>=1n,r=r.square();return n}div(e){const t="bigint"==typeof e?new c(e).invert().value:e.invert();return this.multiply(t)}}const s=0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,d=0x699be3b8c6870965e5bf892ad5d2cc7b0e85a117402dfd83b7f4a947e02d978498255a2aaec0ac627b5afbdf1bf1c90n,b=0x8157cd83046453f5dd0972b6e3949e4288020b5b8a9cc99ca07e27089a2ce2436d965026adad3ef7baba37f2183e9b5n,p=0xab1c2ffdd6c253ca155231eb3e71ba044fd562f6f72bc5bad5ec46a0b7a3b0247cf08ce6c6317f40edbc653a72dee17n,y=0xaa404866706722864480885d68ad0ccac1967c7544b447873cc37e0181271e006df72162a3d3e0287bf597fbf7f8fc1n;class m extends l{constructor(e){if(super(),2!==e.length)throw new Error("Expected array with 2 elements");e.forEach(((t,n)=>{"bigint"==typeof t&&(e[n]=new c(t))})),this.c=e}init(e){return new m(e)}toString(){return`Fq2(${this.c[0]} + ${this.c[1]}Ã—i)`}get values(){return this.c.map((e=>e.value))}multiply(e){if("bigint"==typeof e)return new m(this.map((t=>t.multiply(e))));const[t,n]=this.c,[r,i]=e.c;let a=t.multiply(r),f=n.multiply(i);return new m([a.subtract(f),t.add(n).multiply(r.add(i)).subtract(a.add(f))])}mulByNonresidue(){const e=this.c[0],t=this.c[1];return new m([e.subtract(t),e.add(t)])}square(){const e=this.c[0],t=this.c[1],n=e.add(t),r=e.subtract(t),i=e.add(e);return new m([n.multiply(r),i.multiply(t)])}sqrt(){const e=this.pow((m.ORDER+8n)/16n),t=e.square().div(this),n=m.ROOTS_OF_UNITY,r=[n[0],n[2],n[4],n[6]].find((e=>e.equals(t)));if(!r)return;const i=n.indexOf(r),a=n[i/2];if(!a)throw new Error("Invalid root");const f=e.div(a),u=f.negate(),[c,o]=f.values,[l,s]=u.values;return o>s||o===s&&c>l?f:u}invert(){const[e,t]=this.values,n=new c(e*e+t*t).invert();return new m([n.multiply(new c(e)),n.multiply(new c(-t))])}frobeniusMap(e){return new m([this.c[0],this.c[1].multiply(m.FROBENIUS_COEFFICIENTS[e%2])])}multiplyByB(){let[e,t]=this.c,n=e.multiply(4n),r=t.multiply(4n);return new m([n.subtract(r),n.add(r)])}}t.Fq2=m,m.ORDER=t.CURVE.P2,m.MAX_BITS=a(t.CURVE.P2),m.ROOT=new c(-1n),m.ZERO=new m([0n,0n]),m.ONE=new m([1n,0n]),m.COFACTOR=t.CURVE.h2,m.ROOTS_OF_UNITY=[new m([1n,0n]),new m([s,-s]),new m([0n,1n]),new m([s,s]),new m([-1n,0n]),new m([-s,s]),new m([0n,-1n]),new m([-s,-s])],m.ETAs=[new m([d,b]),new m([-b,d]),new m([p,y]),new m([-y,p])],m.FROBENIUS_COEFFICIENTS=[new c(0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n),new c(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan)];class h extends l{constructor(e){if(super(),this.c=e,3!==e.length)throw new Error("Expected array with 3 elements")}static fromTuple(e){return new h([new m(e.slice(0,2)),new m(e.slice(2,4)),new m(e.slice(4,6))])}init(e){return new h(e)}toString(){return`Fq6(${this.c[0]} + ${this.c[1]} * v, ${this.c[2]} * v^2)`}conjugate(){throw new TypeError("No conjugate on Fq6")}multiply(e){if("bigint"==typeof e)return new h([this.c[0].multiply(e),this.c[1].multiply(e),this.c[2].multiply(e)]);let[t,n,r]=this.c;const[i,a,f]=e.c;let u=t.multiply(i),c=n.multiply(a),o=r.multiply(f);return new h([u.add(n.add(r).multiply(a.add(f)).subtract(c.add(o)).mulByNonresidue()),t.add(n).multiply(i.add(a)).subtract(u.add(c)).add(o.mulByNonresidue()),c.add(t.add(r).multiply(i.add(f)).subtract(u.add(o)))])}mulByNonresidue(){return new h([this.c[2].mulByNonresidue(),this.c[0],this.c[1]])}multiplyBy1(e){return new h([this.c[2].multiply(e).mulByNonresidue(),this.c[0].multiply(e),this.c[1].multiply(e)])}multiplyBy01(e,t){let[n,r,i]=this.c,a=n.multiply(e),f=r.multiply(t);return new h([r.add(i).multiply(t).subtract(f).mulByNonresidue().add(a),e.add(t).multiply(n.add(r)).subtract(a).subtract(f),n.add(i).multiply(e).subtract(a).add(f)])}multiplyByFq2(e){return new h(this.map((t=>t.multiply(e))))}square(){let[e,t,n]=this.c,r=e.square(),i=e.multiply(t).multiply(2n),a=t.multiply(n).multiply(2n),f=n.square();return new h([a.mulByNonresidue().add(r),f.mulByNonresidue().add(i),i.add(e.subtract(t).add(n).square()).add(a).subtract(r).subtract(f)])}invert(){let[e,t,n]=this.c,r=e.square().subtract(n.multiply(t).mulByNonresidue()),i=n.square().mulByNonresidue().subtract(e.multiply(t)),a=t.square().subtract(e.multiply(n)),f=n.multiply(i).add(t.multiply(a)).mulByNonresidue().add(e.multiply(r)).invert();return new h([f.multiply(r),f.multiply(i),f.multiply(a)])}frobeniusMap(e){return new h([this.c[0].frobeniusMap(e),this.c[1].frobeniusMap(e).multiply(h.FROBENIUS_COEFFICIENTS_1[e%6]),this.c[2].frobeniusMap(e).multiply(h.FROBENIUS_COEFFICIENTS_2[e%6])])}}t.Fq6=h,h.ZERO=new h([m.ZERO,m.ZERO,m.ZERO]),h.ONE=new h([m.ONE,m.ZERO,m.ZERO]),h.FROBENIUS_COEFFICIENTS_1=[new m([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn]),new m([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n]),new m([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n,0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen])],h.FROBENIUS_COEFFICIENTS_2=[new m([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n])];class w extends l{constructor(e){if(super(),this.c=e,2!==e.length)throw new Error("Expected array with 2 elements")}static fromTuple(e){return new w([h.fromTuple(e.slice(0,6)),h.fromTuple(e.slice(6,12))])}init(e){return new w(e)}toString(){return`Fq12(${this.c[0]} + ${this.c[1]} * w)`}multiply(e){if("bigint"==typeof e)return new w([this.c[0].multiply(e),this.c[1].multiply(e)]);let[t,n]=this.c;const[r,i]=e.c;let a=t.multiply(r),f=n.multiply(i);return new w([a.add(f.mulByNonresidue()),t.add(n).multiply(r.add(i)).subtract(a.add(f))])}multiplyBy014(e,t,n){let[r,i]=this.c,[a,f]=[r.multiplyBy01(e,t),i.multiplyBy1(n)];return new w([f.mulByNonresidue().add(a),i.add(r).multiplyBy01(e,t.add(n)).subtract(a).subtract(f)])}multiplyByFq2(e){return this.init(this.map((t=>t.multiplyByFq2(e))))}square(){let[e,t]=this.c,n=e.multiply(t);return new w([t.mulByNonresidue().add(e).multiply(e.add(t)).subtract(n).subtract(n.mulByNonresidue()),n.add(n)])}invert(){let[e,t]=this.c,n=e.square().subtract(t.square().mulByNonresidue()).invert();return new w([e.multiply(n),t.multiply(n).negate()])}frobeniusMap(e){const[t,n]=this.c;let r=t.frobeniusMap(e),[i,a,f]=n.frobeniusMap(e).c;return new w([r,new h([i.multiply(w.FROBENIUS_COEFFICIENTS[e%12]),a.multiply(w.FROBENIUS_COEFFICIENTS[e%12]),f.multiply(w.FROBENIUS_COEFFICIENTS[e%12])])])}Fq4Square(e,t){const n=e.square(),r=t.square();return[r.mulByNonresidue().add(n),e.add(t).square().subtract(n).subtract(r)]}cyclotomicSquare(){const[e,t]=this.c,[n,r,i]=e.c,[a,f,u]=t.c;let[c,o]=this.Fq4Square(n,f),[l,s]=this.Fq4Square(a,i),[d,b]=this.Fq4Square(r,u),p=b.mulByNonresidue();return new w([new h([c.subtract(n).multiply(2n).add(c),l.subtract(r).multiply(2n).add(l),d.subtract(i).multiply(2n).add(d)]),new h([p.add(a).multiply(2n).add(p),o.add(f).multiply(2n).add(o),s.add(u).multiply(2n).add(s)])])}cyclotomicExp(e){let t=w.ONE;for(let r=n-1;r>=0;r--)t=t.cyclotomicSquare(),f(e,r)&&(t=t.multiply(this));return t}finalExponentiate(){const{x:e}=t.CURVE,n=this.frobeniusMap(6).div(this),r=n.frobeniusMap(2).multiply(n),i=r.cyclotomicExp(e).conjugate(),a=r.cyclotomicSquare().conjugate().multiply(i),f=a.cyclotomicExp(e).conjugate(),u=f.cyclotomicExp(e).conjugate(),c=u.cyclotomicExp(e).conjugate().multiply(i.cyclotomicSquare()),o=c.cyclotomicExp(e).conjugate(),l=i.multiply(u).frobeniusMap(2),s=f.multiply(r).frobeniusMap(3),d=c.multiply(r.conjugate()).frobeniusMap(1),b=o.multiply(a.conjugate()).multiply(r);return l.multiply(s).multiply(d).multiply(b)}}t.Fq12=w,w.ZERO=new w([h.ZERO,h.ZERO]),w.ONE=new w([h.ONE,h.ZERO]),w.FROBENIUS_COEFFICIENTS=[new m([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n]),new m([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n]),new m([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n]),new m([0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n]),new m([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n]),new m([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new m([0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n])];function E(e){const[t,n]=e.values;return BigInt(t%2n||0n===t&&n%2n)}t.ProjectivePoint=class{constructor(e,t,n,r){this.x=e,this.y=t,this.z=n,this.C=r}isZero(){return this.z.isZero()}getPoint(e,t,n){return new this.constructor(e,t,n)}getZero(){return this.getPoint(this.C.ONE,this.C.ONE,this.C.ZERO)}equals(e){if(this.constructor!==e.constructor)throw new Error(`ProjectivePoint#equals: this is ${this.constructor}, but rhs is ${e.constructor}`);const t=this,n=e,r=t.x.multiply(n.z).equals(n.x.multiply(t.z)),i=t.y.multiply(n.z).equals(n.y.multiply(t.z));return r&&i}negate(){return this.getPoint(this.x,this.y.negate(),this.z)}toString(e=!0){if(!e)return`Point<x=${this.x}, y=${this.y}, z=${this.z}>`;const[t,n]=this.toAffine();return`Point<x=${t}, y=${n}>`}fromAffineTuple(e){return this.getPoint(e[0],e[1],this.C.ONE)}toAffine(e=this.z.invert()){return[this.x.multiply(e),this.y.multiply(e)]}toAffineBatch(e){const t=function(e,t){const n=t.length,r=new Array(n);let i=e.ONE;for(let e=0;e<n;e++)t[e].isZero()||(r[e]=i,i=i.multiply(t[e]));i=i.invert();for(let e=n-1;e>=0;e--){if(t[e].isZero())continue;let n=i.multiply(t[e]);t[e]=i.multiply(r[e]),i=n}return t}(this.C,e.map((e=>e.z)));return e.map(((e,n)=>e.toAffine(t[n])))}normalizeZ(e){return this.toAffineBatch(e).map((e=>this.fromAffineTuple(e)))}double(){const{x:e,y:t,z:n}=this,r=e.multiply(e).multiply(3n),i=t.multiply(n),a=i.multiply(i),f=a.multiply(i),u=e.multiply(t).multiply(i),c=r.multiply(r).subtract(u.multiply(8n)),o=c.multiply(i).multiply(2n),l=r.multiply(u.multiply(4n).subtract(c)).subtract(t.multiply(t).multiply(8n).multiply(a)),s=f.multiply(8n);return this.getPoint(o,l,s)}add(e){if(this.constructor!==e.constructor)throw new Error(`ProjectivePoint#add: this is ${this.constructor}, but rhs is ${e.constructor}`);const t=this,n=e;if(t.isZero())return n;if(n.isZero())return t;const r=t.x,i=t.y,a=t.z,f=n.x,u=n.y,c=n.z,o=u.multiply(a),l=i.multiply(c),s=f.multiply(a),d=r.multiply(c);if(s.equals(d)&&o.equals(l))return this.double();if(s.equals(d))return this.getZero();const b=o.subtract(l),p=s.subtract(d),y=p.multiply(p),m=y.multiply(p),h=d.multiply(y),w=a.multiply(c),E=b.multiply(b).multiply(w).subtract(m).subtract(h.multiply(2n)),g=p.multiply(E),x=b.multiply(h.subtract(E)).subtract(m.multiply(l)),v=m.multiply(w);return this.getPoint(g,x,v)}subtract(e){if(this.constructor!==e.constructor)throw new Error(`ProjectivePoint#subtract: this is ${this.constructor}, but rhs is ${e.constructor}`);return this.add(e.negate())}multiplyUnsafe(e){let t=e;if(t instanceof c&&(t=t.value),"number"==typeof t&&(t=BigInt(t)),t<0)throw new Error("Point#multiply: invalid scalar, expected positive integer");let n=this.getZero(),r=this;for(;t>0n;)1n&t&&(n=n.add(r)),r=r.double(),t>>=1n;return n}multiply(e){let t=e;if("bigint"!=typeof t||t<0)throw new Error("Point#multiply: invalid scalar, expected positive integer");let n=this.getZero(),r=this,i=this.getZero(),a=c.ORDER;if(t>a)throw new Error("higher:"+t);for(;a>0n;)1n&t?n=n.add(r):i=i.add(r),r=r.double(),t>>=1n,a>>=1n;return n}maxBits(){return this.C.MAX_BITS}precomputeWindow(e){const t=Math.ceil(this.maxBits()/e),n=2**(e-1);let r=[],i=this,a=i;for(let e=0;e<t;e++){a=i,r.push(a);for(let e=1;e<n;e++)a=a.add(i),r.push(a);i=a.double()}return r}calcMultiplyPrecomputes(e){if(this._MPRECOMPUTES)throw new Error("This point already has precomputes");this._MPRECOMPUTES=[e,this.normalizeZ(this.precomputeWindow(e))]}clearMultiplyPrecomputes(){this._MPRECOMPUTES=void 0}wNAF(e){let t,n;this._MPRECOMPUTES?[t,n]=this._MPRECOMPUTES:(t=1,n=this.precomputeWindow(t));let[r,i]=[this.getZero(),this.getZero()];const a=Math.ceil(this.maxBits()/t),f=2**(t-1),u=BigInt(2**t-1),c=2**t,o=BigInt(t);for(let t=0;t<a;t++){const a=t*f;let l=Number(e&u);if(e>>=o,l>f&&(l-=c,e+=1n),0===l)i=i.add(t%2?n[a].negate():n[a]);else{const e=n[a+Math.abs(l)-1];r=r.add(l<0?e.negate():e)}}return[r,i]}multiplyPrecomputed(e){if(!("bigint"==typeof e)||e<1n)throw new Error("ProjectivePoint#multiply: invalid scalar, expected positive integer");return this.wNAF(e)[0]}};const g=(t.CURVE.P**2n-9n)/16n;t.map_to_curve_SSWU_G2=function(e){const t=new m([0n,240n]),n=new m([1012n,1012n]),r=new m([-2n,-1n]);Array.isArray(e)&&(e=new m(e));const i=e.pow(2n),a=r.multiply(i),f=a.add(a.pow(2n));let u=t.multiply(f).negate(),c=n.multiply(f.add(m.ONE));u.isZero()&&(u=r.multiply(t));let o=u.pow(3n),l=c.pow(3n).add(t.multiply(c).multiply(u.pow(2n))).add(n.multiply(o));const[s,d]=function(e,t){const n=t.pow(7n),r=e.multiply(n),i=r.multiply(n.multiply(t)).pow(g).multiply(r);let a=!1,f=i;const u=m.ROOTS_OF_UNITY.slice(0,4);for(const n of u){const r=n.multiply(i);r.pow(2n).multiply(t).subtract(e).isZero()&&!a&&(a=!0,f=r)}return[a,f]}(l,o);let b;s&&(b=d);const p=d.multiply(e.pow(3n));l=a.pow(3n).multiply(l);let y=!1;for(const e of m.ETAs){const t=e.multiply(p);!t.pow(2n).multiply(o).subtract(l).isZero()||s||y||(b=t,y=!0)}if(!s&&!y)throw new Error("Hash to Curve - Optimized SWU failure");return y&&(c=c.multiply(a)),b=b,E(e)!==E(b)&&(b=b.negate()),b=b.multiply(u),[c,b,u]},t.isogenyMapG2=function(e){const[n,r,i]=e,a=[m.ZERO,m.ZERO,m.ZERO,m.ZERO],f=[i,i.pow(2n),i.pow(3n)];for(let e=0;e<t.isogenyCoefficients.length;e++){const r=t.isogenyCoefficients[e];a[e]=r.slice(-1)[0];const i=r.slice(0,-1).reverse();for(let t=0;t<i.length;t++){const r=i[t];a[e]=a[e].multiply(n).add(f[t].multiply(r))}}a[2]=a[2].multiply(r),a[3]=a[3].multiply(i);const u=a[1].multiply(a[3]);return[a[0].multiply(a[3]),a[1].multiply(a[2]),u]},t.calcPairingPrecomputes=function(e,r){const[i,a,u]=[e,r,m.ONE];let[c,o,l]=[i,a,u],s=[];for(let e=n-2;e>=0;e--){let n=o.square(),r=l.square(),u=r.multiply(3n).multiplyByB(),d=u.multiply(3n),b=o.add(l).square().subtract(r).subtract(n);if(s.push([u.subtract(n),c.square().multiply(3n),b.negate()]),c=n.subtract(d).multiply(c).multiply(o).div(2n),o=n.add(d).div(2n).square().subtract(u.square().multiply(3n)),l=n.multiply(b),f(t.CURVE.x,e)){let e=o.subtract(a.multiply(l)),t=c.subtract(i.multiply(l));s.push([e.multiply(i).subtract(t.multiply(a)),e.negate(),t]);let n=t.square(),r=n.multiply(t),f=n.multiply(c),u=r.subtract(f.multiply(2n)).add(e.square().multiply(l));c=t.multiply(u),o=f.subtract(u).multiply(e).subtract(r.multiply(o)),l=l.multiply(r)}}return s},t.millerLoop=function(e,r){let i=w.ONE;const[a,u]=r,[c,o]=[a,u];for(let r=0,a=n-2;a>=0;a--,r++)i=i.multiplyBy014(e[r][0],e[r][1].multiply(c.value),e[r][2].multiply(o.value)),f(t.CURVE.x,a)&&(r+=1,i=i.multiplyBy014(e[r][0],e[r][1].multiply(c.value),e[r][2].multiply(o.value))),0!==a&&(i=i.square());return i.conjugate()};const x=new h([m.ZERO,m.ONE,m.ZERO]),v=new w([x,h.ZERO]),O=v.invert(),R=new w([h.ZERO,x]),q=R.invert();t.psi=function(e,t){return[O.multiplyByFq2(e).frobeniusMap(1).multiply(v).c[0].c[0],q.multiplyByFq2(t).frobeniusMap(1).multiply(R).c[0].c[0]]};const F=0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn;t.psi2=function(e,t){return[e.multiply(F),t.negate()]};const P=[new m([0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n]),new m([0x0n,0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71an]),new m([0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71en,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38dn]),new m([0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1n,0x0n])],S=[new m([0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63n]),new m([0xcn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9fn]),m.ONE,m.ZERO],B=[new m([0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n,0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n]),new m([0x0n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97ben]),new m([0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71cn,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38fn]),new m([0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10n,0x0n])],N=[new m([0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn]),new m([0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3n]),new m([0x12n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99n]),new m([0x1n,0x0n])];t.isogenyCoefficients=[P,S,B,N]})),S=q(Object.freeze({__proto__:null,default:{}})),B=F((function(e,t){
/*! noble-bls12-381 - MIT License (c) Paul Miller (paulmillr.com) */
Object.defineProperty(t,"__esModule",{value:!0}),t.verifyBatch=t.aggregateSignatures=t.aggregatePublicKeys=t.verify=t.sign=t.getPublicKey=t.pairing=t.PointG2=t.clearCofactorG2=t.PointG1=t.hash_to_field=t.utils=t.CURVE=t.Fq12=t.Fq2=t.Fr=t.Fq=t.DST_LABEL=void 0,Object.defineProperty(t,"Fq",{enumerable:!0,get:function(){return P.Fq}}),Object.defineProperty(t,"Fr",{enumerable:!0,get:function(){return P.Fr}}),Object.defineProperty(t,"Fq2",{enumerable:!0,get:function(){return P.Fq2}}),Object.defineProperty(t,"Fq12",{enumerable:!0,get:function(){return P.Fq12}}),Object.defineProperty(t,"CURVE",{enumerable:!0,get:function(){return P.CURVE}});const n=P.CURVE.P;t.DST_LABEL="BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_";const r=2n**381n,i=2n*r,a=2n*i,f=48;function u(e){let t=0n;for(let n=e.length-1,r=0;n>=0;n--,r++)t+=(255n&BigInt(e[n]))<<8n*BigInt(r);return t}function c(e){let t="";for(let n=0;n<e.length;n++)t+=e[n].toString(16).padStart(2,"0");return t}function o(e){if("string"!=typeof e||e.length%2)throw new Error("Expected valid hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n;t[n]=Number.parseInt(e.slice(r,r+2),16)}return t}function l(e,t){if(e<0n)throw new Error("Expected valid number");if("number"!=typeof t)throw new TypeError("Expected valid padding");return e.toString(16).padStart(2*t,"0")}function s(e){if("string"!=typeof e&&!(e instanceof Uint8Array))throw new TypeError("Expected hex string or Uint8Array")}function d(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}function b(e){let t=0n;for(let n=0;n<e.length;n++)t<<=8n,t+=BigInt(e[n]);return t}function p(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);const n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=255&e,e>>>=8;return new Uint8Array(n)}function y(e,t){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}async function m(e,n,r=!0){const i=r?2:1,a=n,f=i*a*64,u=function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(t.DST_LABEL),c=await async function(e,n,r){const i=t.utils.sha256,a=Math.ceil(r/32);if(a>255)throw new Error("Invalid xmd length");const f=d(n,p(n.length,1)),u=p(0,64),c=p(r,2),o=new Array(a),l=await i(d(u,e,c,p(0,1),f));o[0]=await i(d(l,p(1,1),f));for(let e=1;e<=a;e++){const t=[y(l,o[e-1]),p(e+1,1),f];o[e]=await i(d(...t))}return d(...o).slice(0,r)}(e,u,f),o=new Array(i);for(let e=0;e<i;e++){const t=new Array(a);for(let n=0;n<a;n++){const r=64*(n+e*a),i=c.slice(r,r+64);t[n]=P.mod(b(i),P.CURVE.P)}o[e]=t}return o}function h(e){let t;if(e instanceof Uint8Array&&32===e.length)t=u(e);else if("string"==typeof e&&64===e.length)t=BigInt(`0x${e}`);else if("number"==typeof e&&e>0&&Number.isSafeInteger(e))t=BigInt(e);else{if(!("bigint"==typeof e&&e>0n))throw new TypeError("Expected valid private key");t=e}if(t=P.mod(t,P.CURVE.r),t<1n)throw new Error("Private key must be 0 < key < CURVE.r");return t}t.utils={async sha256(e){if("object"==typeof window&&"crypto"in window){const t=await window.crypto.subtle.digest("SHA-256",e.buffer);return new Uint8Array(t)}if("object"==typeof R&&"node"in R.versions){const{createHash:t}=S,n=t("sha256");return n.update(e),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have sha256 function")},randomPrivateKey:(e=32)=>{if("object"==typeof window&&"crypto"in window)return window.crypto.getRandomValues(new Uint8Array(e));if("object"==typeof R&&"node"in R.versions){const{randomBytes:t}=S;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},mod:P.mod},t.hash_to_field=m;class w extends P.ProjectivePoint{constructor(e,t,n){super(e,t,n,P.Fq)}static fromHex(e){let t;if(s(e),"string"==typeof e&&(e=o(e)),48===e.length){const f=u(e);if(1n===P.mod(f,a)/i)return this.ZERO;const c=P.mod(f,r),o=P.mod(c**3n+new P.Fq(P.CURVE.b).value,n);let l=P.powMod(o,(n+1n)/4n,n);if(P.powMod(l,2n,n)-o!==0n)throw new Error("The given point is not on G1: y**2 = x**3 + b");const s=P.mod(f,i)/r;2n*l/n!==s&&(l=n-l),t=new w(new P.Fq(c),new P.Fq(l),new P.Fq(1n))}else{if(96!==e.length)throw new Error("Invalid point G1, expected 48/96 bytes");{if(0!=(64&e[0]))return w.ZERO;const n=u(e.slice(0,f)),r=u(e.slice(f));t=new w(new P.Fq(n),new P.Fq(r),P.Fq.ONE)}}return t.assertValidity(),t}static fromPrivateKey(e){return this.BASE.multiplyPrecomputed(h(e))}toRawBytes(e=!1){return o(this.toHex(e))}toHex(e=!1){if(e){let e;if(this.equals(w.ZERO))e=a+i;else{const[t,i]=this.toAffine(),f=2n*i.value/n;e=t.value+f*r+a}return l(e,f)}if(this.equals(w.ZERO))return"4".padEnd(192,"0");{const[e,t]=this.toAffine();return l(e.value,f)+l(t.value,f)}}assertValidity(){const e=new P.Fq(P.CURVE.b);if(this.isZero())return;const{x:t,y:n,z:r}=this,i=n.pow(2n).multiply(r).subtract(t.pow(3n)),a=e.multiply(r.pow(3n));if(!i.subtract(a).equals(P.Fq.ZERO))throw new Error("Invalid point: not on curve Fq")}toRepr(){return[this.x,this.y,this.z].map((e=>e.value))}millerLoop(e){return P.millerLoop(e.pairingPrecomputes(),this.toAffine())}}function E(e){const t=e.multiplyUnsafe(P.CURVE.x).negate(),n=e.fromAffineTuple(P.psi(...e.toAffine()));return e.fromAffineTuple(P.psi2(...e.double().toAffine())).subtract(n).add(t.add(n).multiplyUnsafe(P.CURVE.x).negate()).subtract(t).subtract(e)}t.PointG1=w,w.BASE=new w(new P.Fq(P.CURVE.Gx),new P.Fq(P.CURVE.Gy),P.Fq.ONE),w.ZERO=new w(P.Fq.ONE,P.Fq.ONE,P.Fq.ZERO),t.clearCofactorG2=E;class g extends P.ProjectivePoint{constructor(e,t,n){super(e,t,n,P.Fq2)}static async hashToCurve(e){s(e),"string"==typeof e&&(e=o(e));const t=await m(e,2),n=new g(...P.isogenyMapG2(P.map_to_curve_SSWU_G2(t[0]))),r=new g(...P.isogenyMapG2(P.map_to_curve_SSWU_G2(t[1])));return E(n.add(r))}static fromSignature(e){s(e),"string"==typeof e&&(e=o(e));const t=e.length/2;if(48!==t&&96!==t)throw new Error("Invalid compressed signature length, must be 96 or 192");const f=u(e.slice(0,t)),c=u(e.slice(t));if(1n===P.mod(f,a)/i)return this.ZERO;const l=f%r,d=c,b=new P.Fq2([d,l]);let p=b.pow(3n).add(new P.Fq2(P.CURVE.b2)).sqrt();if(!p)throw new Error("Failed to find a square root");const[y,m]=p.values,h=f%i/r;(m>0n&&2n*m/n!==h||0n===m&&2n*y/n!==h)&&(p=p.multiply(-1n));const w=new g(b,p,P.Fq2.ONE);return w.assertValidity(),w}static fromHex(e){let t;if(s(e),"string"==typeof e&&(e=o(e)),96===e.length)throw new Error("Compressed format not supported yet.");if(192!==e.length)throw new Error("Invalid uncompressed point G2, expected 192 bytes");{if(0!=(64&e[0]))return g.ZERO;const n=u(e.slice(0,f)),r=u(e.slice(f,96)),i=u(e.slice(96,144)),a=u(e.slice(144));t=new g(new P.Fq2([r,n]),new P.Fq2([a,i]),P.Fq2.ONE)}return t.assertValidity(),t}static fromPrivateKey(e){return this.BASE.multiplyPrecomputed(h(e))}toSignature(){if(this.equals(g.ZERO)){return l(a+i,f)+l(0n,f)}this.assertValidity();const[[e,t],[n,u]]=this.toAffine().map((e=>e.values)),c=e;return l(t+(u>0n?2n*u:2n*n)/P.CURVE.P*r+a,f)+l(c,f)}toRawBytes(e=!1){return o(this.toHex(e))}toHex(e=!1){if(e)throw new Error("Not supported");if(this.equals(g.ZERO))return"4".padEnd(384,"0");{this.assertValidity();const[[e,t],[n,r]]=this.toAffine().map((e=>e.values));return l(t,f)+l(e,f)+l(r,f)+l(n,f)}}assertValidity(){const e=new P.Fq2(P.CURVE.b2);if(this.isZero())return;const{x:t,y:n,z:r}=this,i=n.pow(2n).multiply(r).subtract(t.pow(3n)),a=e.multiply(r.pow(3n));if(!i.subtract(a).equals(P.Fq2.ZERO))throw new Error("Invalid point: not on curve Fq2")}toRepr(){return[this.x,this.y,this.z].map((e=>e.values))}clearPairingPrecomputes(){this._PPRECOMPUTES=void 0}pairingPrecomputes(){return this._PPRECOMPUTES||(this._PPRECOMPUTES=P.calcPairingPrecomputes(...this.toAffine())),this._PPRECOMPUTES}}function x(e,t,n=!0){if(e.isZero()||t.isZero())throw new Error("No pairings at point of Infinity");e.assertValidity(),t.assertValidity();const r=e.millerLoop(t);return n?r.finalExponentiate():r}function v(e){return e instanceof w?e:(s(e),w.fromHex(e))}function O(e){return e instanceof g?e:(s(e),g.fromSignature(e))}async function q(e){return e instanceof g?e:(s(e),await g.hashToCurve(e))}t.PointG2=g,g.BASE=new g(new P.Fq2(P.CURVE.G2x),new P.Fq2(P.CURVE.G2y),P.Fq2.ONE),g.ZERO=new g(P.Fq2.ONE,P.Fq2.ONE,P.Fq2.ZERO),t.pairing=x,t.getPublicKey=function(e){const t=w.fromPrivateKey(e).toRawBytes(!0);return"string"==typeof e?c(t):t},t.sign=async function(e,t){const n=await q(e);n.assertValidity();const r=n.multiply(h(t));if(e instanceof g)return r;const i=r.toSignature();return"string"==typeof e?i:o(i)},t.verify=async function(e,t,n){const r=v(n),i=await q(t),a=w.BASE,f=O(e),u=x(r.negate(),i,!1);return x(a,f,!1).multiply(u).finalExponentiate().equals(P.Fq12.ONE)},t.aggregatePublicKeys=function(e){if(!e.length)throw new Error("Expected non-empty array");const t=e.map(v).reduce(((e,t)=>e.add(t)),w.ZERO);if(e[0]instanceof w)return t;const n=t.toRawBytes(!0);return e[0]instanceof Uint8Array?n:c(n)},t.aggregateSignatures=function(e){if(!e.length)throw new Error("Expected non-empty array");const t=e.map(O).reduce(((e,t)=>e.add(t)),g.ZERO);if(e[0]instanceof g)return t;const n=t.toSignature();return e[0],Uint8Array,n},t.verifyBatch=async function(e,t,n){if(!t.length)throw new Error("Expected non-empty messages array");if(n.length!==t.length)throw new Error("Pubkey count should equal msg count");const r=O(e),i=await Promise.all(t.map(q)),a=n.map(v);try{const e=[];for(const t of new Set(i)){const n=i.reduce(((e,n,r)=>n===t?e.add(a[r]):e),w.ZERO);e.push(x(n,t,!1))}e.push(x(w.BASE.negate(),r,!1));const t=e.reduce(((e,t)=>e.multiply(t)),P.Fq12.ONE);return t.finalExponentiate().equals(P.Fq12.ONE)}catch{return!1}},w.BASE.calcMultiplyPrecomputes(4)}));const N=e=>new B.Fr(C(_(e))),_=e=>{e.startsWith("0x")&&(e=e.slice(2));const t=e.length;let n="";for(let r=0;r<t/2;r++)n+=e.substring(t-2*(r+1),t-2*r);return n},C=e=>BigInt(`0x${e}`),U={addG1:(e,t)=>{const n=B.PointG1.fromHex(e);n.assertValidity();const r=B.PointG1.fromHex(t);return r.assertValidity(),n.add(r).toHex()},addG2:(e,t)=>{const n=B.PointG2.fromHex(e);n.assertValidity();const r=B.PointG2.fromHex(t);return r.assertValidity(),n.add(r).toHex()},addFr:(e,t)=>{const n=N(e),r=N(t);return _(n.add(r).toString())},multiplyG1ByFr:(e,t)=>{const n=B.PointG1.fromHex(e);return n.assertValidity(),n.multiply(C(_(t))).toHex()},multiplyG2ByFr:(e,t)=>{const n=B.PointG2.fromHex(e);return n.assertValidity(),n.multiply(C(_(t))).toHex()},multiplyFrByFr:(e,t)=>{const n=N(e),r=N(t);return _(n.multiply(r).toString())},multiplyFrByInt:(e,t)=>_(N(e).multiply(BigInt(t)).toString()),negateG1:e=>{const t=B.PointG1.fromHex(e).negate();return t.assertValidity(),t.toHex()},negateG2:e=>{const t=B.PointG2.fromHex(e).negate();return t.assertValidity(),t.toHex()},negateFr:e=>{const t=N(e);return _(t.negate().toString())},convertFrToInt:e=>C(_(e)).toString(10),pairingCheck:e=>{let t=!0;if(e.length>0){const n=B.PointG1.fromHex(e[0][0]);n.assertValidity();const r=B.PointG2.fromHex(e[0][1]);r.assertValidity();const i=B.PointG1.fromHex(e[1][0]);i.assertValidity();const a=B.PointG2.fromHex(e[1][1]);a.assertValidity();const f=B.pairing(n,r),u=B.pairing(i,a);t=f.multiply(u).equals(B.Fq12.ONE)}return t}};export default U;
